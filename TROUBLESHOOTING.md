# Устранение проблем

## Таймауты

### Ошибка "Promise timed out after 90000 milliseconds"

Эта ошибка возникает, когда операция занимает больше 90 секунд. Чаще всего это происходит при транскрипции длинных видео.

**Решение:**

1. **Транскрипция длинных видео** - Whisper может занимать много времени. Бот автоматически обновляет статус каждые 30 секунд, чтобы показать, что обработка продолжается.

2. **Ограничение длины видео** - Для очень длинных видео (более 1 часа) транскрипция может занимать 10-30 минут. Рекомендуется использовать видео короче 30 минут для быстрой обработки.

3. **Проверьте системные ресурсы** - Убедитесь, что:
   - Достаточно оперативной памяти (рекомендуется минимум 4 ГБ)
   - CPU не перегружен другими процессами
   - Есть свободное место на диске

4. **Используйте более легкую модель Whisper** - В файле `src/services/transcriber.ts` можно изменить модель:
   ```typescript
   // Вместо 'Xenova/whisper-small' используйте:
   'Xenova/whisper-tiny' // Быстрее, но менее точная
   ```

## Другие проблемы

### Бот не отвечает

- Проверьте, что токен бота правильный в `.env`
- Убедитесь, что бот запущен
- Проверьте логи на наличие ошибок

### Ошибка скачивания видео

- См. файл `YT_DLP_SETUP.md` для подробных инструкций
- Убедитесь, что Node.js установлен (используется как JavaScript runtime)
- Обновите yt-dlp: `pip install --upgrade yt-dlp`

### Ошибка транскрипции

- Первый запуск загрузит модель Whisper (может занять время)
- Убедитесь, что есть интернет-соединение
- Проверьте, что есть достаточно места на диске для кэша моделей

### Ошибка генерации статьи

- Проверьте, что Ollama запущен: `ollama list`
- Убедитесь, что модель загружена: `ollama pull llama3`
- Проверьте логи Ollama на наличие ошибок

### Ошибка генерации изображения

- Проверьте интернет-соединение (Hugging Face API требует интернет)
- При необходимости создайте бесплатный токен на https://huggingface.co
- Добавьте токен в `.env`: `HUGGINGFACE_API_TOKEN=your_token`

## Оптимизация производительности

### Для быстрой обработки:

1. Используйте короткие видео (до 10 минут)
2. Используйте модель Whisper-tiny вместо whisper-small
3. Убедитесь, что Ollama использует GPU (если доступно)
4. Закройте другие ресурсоемкие приложения

### Для точной обработки:

1. Используйте модель Whisper-medium или whisper-large
2. Увеличьте таймауты в коде (если нужно)
3. Используйте более мощную модель Ollama (llama3:70b вместо llama3)

## Логирование

Для отладки включите подробное логирование:

1. Проверьте консоль на наличие ошибок
2. Все операции логируются в консоль
3. При ошибках проверяйте полный стек вызовов

## Получение помощи

Если проблема не решена:

1. Проверьте все логи
2. Убедитесь, что все зависимости установлены и обновлены
3. Проверьте системные требования
4. Создайте issue с подробным описанием проблемы и логами



